{"version":3,"sources":["webpack:///webpack/bootstrap 597faa1bd86f3daf5ba6","webpack:///./~/_babel-runtime@6.26.0@babel-runtime/regenerator/index.js","webpack:///external \"koa-router\"","webpack:///./nuxt.config.js","webpack:///./server/routers/index.js","webpack:///external \"@koa/cors\"","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-logger\"","webpack:///external \"koa-session2\"","webpack:///external \"nuxt\"","webpack:///./server/config/index.js","webpack:///./server/controller/user.js","webpack:///external \"axios\"","webpack:///external \"axios-mock-adapter\"","webpack:///external \"regenerator-runtime\"","webpack:///./server/index.js"],"names":["module","exports","head","title","meta","charset","hid","name","content","link","rel","type","href","css","src","plugins","ssr","loading","cache","max","maxAge","router","middleware","build","vendor","extend","config","ctx","isClient","get","post","base_url","sign_key","mock","onPost","reply","userinfo","next","token","session","user","body","ret","msg","data","login","request","mobile","psd","_url","axios","sign","req","status","code","message","signkey","info","id","sex","role_id","depart_id","deader_id","logout","app","host","process","env","HOST","port","PORT","use","key","overwrite","koaLogger","cors","bodyParser","route","routes","allowedMethods","require","dev","nuxt","builder","Promise","resolve","reject","res","on","render","promise","then","catch","listen","console","log","start"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 597faa1bd86f3daf5ba6","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_babel-runtime@6.26.0@babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 1\n// module chunks = 0","module.exports = {\r\n  /*\r\n  ** Headers of the page\r\n  */\r\n  head: {\r\n    title: 'nuxt-temp',\r\n    meta: [\r\n      { charset: 'utf-8' },\r\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\r\n    ],\r\n    link: [\r\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\r\n    ]\r\n  },\r\n  css: [\r\n    { src: '~assets/css/main.css' },\r\n    { src: 'iview/dist/styles/iview.css' }\r\n  ],\r\n  plugins: [\r\n    { src: '~plugins/flexible.js', ssr: false },\r\n    { src: '~plugins/iview.js', ssr: true }\r\n  ],\r\n  loading: './components/loading.vue',\r\n  cache: {\r\n    max: 1000,\r\n    maxAge: 900000\r\n  },\r\n  router: {\r\n    middleware: 'route' // 在每页渲染前运行 middleware/route.js 中间件的逻辑\r\n  },\r\n  build: {\r\n    vendor: ['axios', 'iview', './plugins/iview.js'],\r\n    extend(config, ctx) {\r\n      if (ctx.isClient) {\r\n        // config.module.rules.push({\r\n        //   enforce: 'pre',\r\n        //   test: /\\.(js|vue)$/,\r\n        //   loader: 'eslint-loader',\r\n        //   exclude: /(node_modules)/\r\n        // })\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import Router from 'koa-router'\r\nimport { userinfo, login, logout } from '../controller/user'\r\nconst router = new Router()\r\n\r\nrouter.get('/api/user', userinfo)\r\nrouter.post('/api/login', login)\r\nrouter.post('/api/logout', logout)\r\nrouter.get('/api/logout', logout)\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/routers/index.js","module.exports = require(\"@koa/cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@koa/cors\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"koa-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-logger\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"koa-session2\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-session2\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 9\n// module chunks = 0","const config = {\r\n  base_url: 'https://crmback.tiaoweilian.com',\r\n  sign_key: 'RFHIJUGVCFTRQKJMJKNHGBIOJUHGBNFG'\r\n}\r\n\r\nexport default config\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/index.js","import axios from 'axios'\r\nimport config from '../config'\r\nimport MockAdapter from 'axios-mock-adapter'\r\n\r\nvar mock = new MockAdapter(axios)\r\nmock.onPost(config.base_url + '/api/v1.user/login').reply(function (config) {\r\n  return [\r\n    200,\r\n    {'ret': 200, 'msg': '请求成功', 'data': {'code': 0, 'message': '登录成功', 'token': 'PhU0Sd9zwUSwOQgXnJpj7pgSwdA7YD80', 'id': 1, 'mobile': '13570267076', 'name': '阿鹏', 'sex': 1, 'status': 1, 'role_id': 1, 'depart_id': 1, 'leader_id': 0}}\r\n  ]\r\n})\r\n\r\nexport const userinfo = async (ctx, next) => {\r\n  let token = ctx.session.user.token || ''\r\n  return (ctx.body = {\r\n    ret: 200,\r\n    msg: '获取成功',\r\n    data: { token: token }\r\n  })\r\n}\r\n\r\nexport const login = async (ctx, next) => {\r\n  const { mobile, psd } = ctx.request.body\r\n  if (!mobile || !psd) {\r\n    return (ctx.body = {\r\n      ret: 303,\r\n      msg: '缺少请求参数',\r\n      data: {}\r\n    })\r\n  }\r\n\r\n  // 发起请求\r\n  let _url = config.base_url + '/api/v1.user/login'\r\n  let req = await axios.post(_url, {\r\n    mobile: mobile,\r\n    psd: psd,\r\n    sign: ''\r\n  })\r\n  // 网络异常\r\n  if (req.status !== 200) {\r\n    return (ctx.body = {\r\n      ret: 400,\r\n      msg: '网络通讯异常',\r\n      data: {}\r\n    })\r\n  }\r\n  // 系统异常\r\n  if (req.data.ret !== 200) {\r\n    let ret = req.data.ret || 400\r\n    let msg = req.data.msg || '失败'\r\n    return (ctx.body = {\r\n      ret: ret,\r\n      msg: msg,\r\n      data: {}\r\n    })\r\n  }\r\n\r\n  // 登陆失败\r\n  if (req.data.data.code !== 0) {\r\n    let code = req.data.data.code || -1\r\n    let message = req.data.data.message || '登录失败'\r\n    return (ctx.body = {\r\n      ret: 200,\r\n      msg: '请求成功',\r\n      data: {\r\n        code: code,\r\n        message: message\r\n      }\r\n    })\r\n  }\r\n\r\n  // 登陆成功\r\n  let token = req.data.data.token\r\n  let signkey = config.sign_key\r\n\r\n  let info = {\r\n    id: req.data.data.id,\r\n    mobile: req.data.data.mobile,\r\n    name: req.data.data.name,\r\n    sex: req.data.data.sex,\r\n    status: req.data.data.status,\r\n    role_id: req.data.data.role_id,\r\n    depart_id: req.data.data.depart_id,\r\n    deader_id: req.data.data.deader_id\r\n  }\r\n\r\n  let session = ctx.session\r\n  session.user = {\r\n    token: token,\r\n    sign_key: signkey,\r\n    info: info\r\n  }\r\n  ctx.session = session\r\n\r\n  return (ctx.body = {\r\n    ret: 200,\r\n    msg: '请求成功',\r\n    data: {\r\n      code: 0,\r\n      message: '登录成功',\r\n      token: token,\r\n      info: info\r\n    }\r\n  })\r\n}\r\n\r\nexport const logout = async (ctx, next) => {\r\n  try {\r\n    ctx.session.user = null\r\n    return (ctx.body = {\r\n      ret: 200,\r\n      msg: '请求成功',\r\n      data: {\r\n        code: 0,\r\n        message: '退出成功'\r\n      }\r\n    })\r\n  } catch (e) {\r\n    return (ctx.body = {\r\n      ret: 200,\r\n      msg: '请求成功',\r\n      data: {\r\n        code: -1,\r\n        message: '退出失败'\r\n      }\r\n    })\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/controller/user.js","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"axios-mock-adapter\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios-mock-adapter\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 14\n// module chunks = 0","import Koa from 'koa'\r\nimport { Nuxt, Builder } from 'nuxt'\r\nimport session from 'koa-session2'\r\nimport bodyParser from 'koa-bodyparser'\r\nimport Router from 'koa-router'\r\nimport koaLogger from 'koa-logger'\r\nimport route from './routers'\r\nimport cors from '@koa/cors'\r\n\r\nasync function start() {\r\n  const app = new Koa()\r\n  const host = process.env.HOST || '127.0.0.1'\r\n  const port = process.env.PORT || 3000\r\n\r\n  // session必须在路由前注册\r\n  app.use(\r\n    session({\r\n      key: '12345',\r\n      overwrite: true\r\n    })\r\n  )\r\n  // 配置控制台日志中间件\r\n  app.use(koaLogger())\r\n  app.use(cors())\r\n  app.use(bodyParser())\r\n\r\n  const router = new Router()\r\n  router.use('', route.routes())\r\n  app.use(router.routes()).use(router.allowedMethods())\r\n\r\n  // Import and Set Nuxt.js options\r\n  let config = require('../nuxt.config.js')\r\n  config.dev = !(app.env === 'production')\r\n\r\n  // Instantiate nuxt.js\r\n  const nuxt = new Nuxt(config)\r\n\r\n  // Build in development\r\n  if (config.dev) {\r\n    const builder = new Builder(nuxt)\r\n    await builder.build()\r\n  }\r\n\r\n  app.use(async (ctx, next) => {\r\n    await next()\r\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\r\n    ctx.req.session = ctx.session // 必须将session添加进request中，否则nuxt的req获取不到session\r\n    return new Promise((resolve, reject) => {\r\n      ctx.res.on('close', resolve)\r\n      ctx.res.on('finish', resolve)\r\n      nuxt.render(ctx.req, ctx.res, promise => {\r\n        // nuxt.render passes a rejected promise into callback on error.\r\n        promise.then(resolve).catch(reject)\r\n      })\r\n    })\r\n  })\r\n\r\n  app.listen(port, host)\r\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\r\n}\r\n\r\nstart()\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}